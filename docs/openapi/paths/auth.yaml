# File: docs/openapi/paths/auth.yaml
# Purpose: Define auth-related OpenAPI path items.
# Why: Keeps the auth surface readable and modular.

Login:
  post:
    tags: [auth]
    summary: Password login
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/auth.yaml#/PasswordLoginRequest'
    responses:
      '200':
        description: Login succeeded
        content:
          application/json:
            schema:
              $ref: '../schemas/auth.yaml#/AuthSuccessResponse'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []

Register:
  post:
    tags: [auth]
    summary: Register a new account
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../schemas/auth.yaml#/RegisterAccountRequest'
    responses:
      '201':
        description: Account created
        content:
          application/json:
            schema:
              $ref: '../schemas/auth.yaml#/AuthSuccessResponse'
      '409':
        description: Conflict
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []

Refresh:
  post:
    tags: [auth]
    summary: Refresh an access token
    requestBody:
      required: false
      content:
        application/json:
          schema:
            $ref: '../schemas/auth.yaml#/RefreshSessionRequest'
    responses:
      '200':
        description: Session refreshed
        content:
          application/json:
            schema:
              $ref: '../schemas/auth.yaml#/AuthSuccessResponse'
      '401':
        description: Unauthorized
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []

Logout:
  post:
    tags: [auth]
    summary: Logout and revoke refresh token
    requestBody:
      required: false
      content:
        application/json:
          schema:
            $ref: '../schemas/auth.yaml#/RefreshSessionRequest'
    responses:
      '204': { description: Logged out }
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []

GoogleStart:
  get:
    tags: [auth]
    summary: Start Google OAuth
    parameters:
      - in: query
        name: returnTo
        required: false
        schema:
          type: string
    responses:
      '200':
        description: Google authorization URL
        content:
          application/json:
            schema:
              $ref: '../schemas/auth.yaml#/GoogleAuthStartResponse'
      '400':
        description: Bad request
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []

GoogleCallback:
  get:
    tags: [auth]
    summary: Complete Google OAuth
    parameters:
      - in: query
        name: code
        required: true
        schema:
          type: string
      - in: query
        name: state
        required: true
        schema:
          type: string
    responses:
      '200':
        description: OAuth completed
        content:
          application/json:
            schema:
              $ref: '../schemas/auth.yaml#/AuthSuccessResponse'
      '303':
        description: Redirects to configured return URL
      '400':
        description: Bad request
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
      '500':
        description: Server error
        content:
          application/json:
            schema:
              $ref: '../schemas/common.yaml#/ErrorResponse'
    security: []
